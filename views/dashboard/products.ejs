<!DOCTYPE html>
<html lang="en">
	<head>
		<%- include('../partials/head.ejs'); %>
	</head>
<body>
  <div id="preloader"></div>
  <div class="header">
    <%- include('../partials/header.ejs', {account: user?.name ?? "", car }); %>
  </div>
  <div class="container mt-5 pt-5">
    <h1>Dashboard</h1>
    <div class="row">
      <div class="col-md-4">
        <div class="card">
          <div class="card-header">
            <h4>Sections</h4>
          </div>
          <div class="card-body">
            <ul class="list-group">
              <li class="list-group-item">
                <a href="/dashboard/products">Products</a>
              </li>
              <li class="list-group-item">
                <a href="/dashboard/categories">Categories</a>
              </li>
              <li class="list-group-item">
                <a href="/dashboard/users">Users</a>
              </li>
              <li class="list-group-item">
                <a href="/dashboard/posts">Posts</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="col-md-8">
        <div class="card p-2">
          <form action="/dashboard/products" method="post" enctype="multipart/form-data" id="form-products">
              <div class="form-group">
                <label for="categoryId">Category:</label>
                <select class="form-control" id="categoryId" name="categoryId" required>
                  <option value="">Select a category</option>
                  <% categories.forEach(category => { %>
                    <option value="<%= category.id %>" data-template="<%= category.template %>"><%= category.name %></option>
                  <% }); %>
                </select>
              </div>

              <div class="form-group">
                <label for="label">Label:</label>
                <select class="form-control" id="label" name="label" required>
                  <option value="">Select a label</option>
                  <% Object.keys(product_label).forEach(label => { %>
                    <option value="<%= label %>"><%= product_label[label] %></option>
                  <% }); %>
                </select>
              </div>

              <div class="form-group">
                <label for="name">Name:</label>
                <input type="text" class="form-control" id="name" name="name" required>
              </div>
              <div class="form-group d-none showDerma">
                <label for="description">Description:</label>
                <textarea class="form-control" id="description" name="description"></textarea>
              </div>
              <div class="form-group">
                <label for="price">Price:</label>
                <input type="number" class="form-control" id="price" name="price" required>
              </div>
              <div class="form-group">
                <label for="quantity">Quantity:</label>
                <input type="number" class="form-control" id="quantity" name="quantity" required>
              </div>
              <div class="form-group row">
                <div class="col-md-11">
                  <label for="sizes">Sizes:</label>
                  <input type="text" class="form-control" id="sizes" maxlength="10" />
                </div>
                <div class="col-md-1">
                  <br />
                  <div class="btn btn-success mt-2" onclick="addSize()">
                    <i class="fas fa-plus"></i>
                  </div>
                </div>
                <div class="col-md-12 d-none" id="box_sizes">
                  <table class="table table-striped table-bordered table-hover mt-2" id="sizes-items">
                    <thead>
                      <tr>
                        <th>Name</th>
                        <th>Action</th>
                      </tr>
                    </thead>
                    <tbody></tbody>
                  </table>
                </div>
              </div>
              <div class="form-group">
                <label for="assessment">Assessment:</label>
                <input type="number" class="form-control" id="assessment" name="assessment" min="0" value="0" required>
              </div>
              <div class="form-group row">
                <div class="col-md-11">
                  <label for="image">Images:</label>
                  <input type="file" class="form-control" id="images" />
                  <input type="file" class="d-none" id="edit-image" />
                </div>
                <div class="col-md-1">
                  <br />
                  <div class="btn btn-success mt-2" onclick="addImage()">
                    <i class="fas fa-plus"></i>
                  </div>
                </div>
                <div class="col-md-12 d-none" id="box_images">
                  <table class="table table-striped table-bordered table-hover mt-2" id="images-items">
                    <thead>
                      <tr>
                        <th>Image</th>
                        <th>Action</th>
                      </tr>
                    </thead>
                    <tbody></tbody>
                  </table>
                </div>
              </div>
              <div class="form-group d-none showDerma">
                <label for="name">Weight:</label>
                <input type="text" class="form-control" id="weight" name="weight" maxlength="25">
              </div>
              <div class="form-group d-none showDerma">
                <label for="name">Dimensions:</label>
                <input type="text" class="form-control" id="dimensions" name="dimensions" maxlength="25">
              </div>

              <div class="form-group d-none showSerum">
                <label for="keyBenefits">Key Benefits:</label>
                <textarea class="form-control" id="keyBenefits" name="keyBenefits"></textarea>
              </div>
              <div class="form-group d-none showDerma showSerum">
                <label for="howUse" id="text_howUse">How to use:</label>
                <textarea class="form-control" id="howUse" name="howUse"></textarea>
              </div>
              <div class="form-group d-none showSerum">
                <label for="ingredients">Full ingredients list:</label>
                <textarea class="form-control" id="ingredients" name="ingredients"></textarea>
              </div>
              <div class="form-group d-none showDerma showSerum">
                <label for="caution" id="text_caution">Caution:</label>
                <textarea class="form-control" id="caution" name="caution"></textarea>
              </div>
              <hr />
              <button type="submit" class="btn btn-primary" id="button_submit">Submit</button>
              <button class="btn btn-secondary d-none" id="button_cancel" onclick="cancel()">Cancel</button>
          </form>
        </div>

        <div class="card mt-2">
          <div class="card-header">
            <h4>Products</h4>
          </div>
          <table class='table table-striped table-bordered table-hover'>
            <thead>
              <tr>
                <th>Name</th>
                <th>Price</th>
                <th>Quantity</th>
                <th>Sizes</th>
                <th>Assessment</th>
                <th>Weight</th>
                <th>Dimensions</th>
                <th class="text-center">Action</th>
              </tr>
            </thead>
            <% products.map(product => { %>
              <tr>
                <td id="<%= product.id %>-name"><%= product.name %></td>
                <td><%= product.price %>$</td>
                <td><%= product.quantity %></td>
                <td><%= product.sizes %></td>
                <td><%= product.assessment %></td>
                <td><%= product.weight %></td>
                <td><%= product.dimensions %></td>
                <td class="text-center">
                  <button class="btn btn-success" onclick="showEdit('<%= product.id %>')">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button class="btn btn-danger" onclick="confirmDelete('<%= product.id %>')">
                    <i class="fas fa-trash"></i>
                  </button>
                </td>
              </tr>
            <% }) %>
          </table>
        </div>
      </div>
    </div>
  </div>

  <%- include('../partials/script.ejs'); %>

  <script src="/assets/js/dashboard-product.js"></script>

</body>
</html>